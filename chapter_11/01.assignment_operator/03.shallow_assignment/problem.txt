double free and memory leaks occured.
